# 技术栈配置总结

生成时间: 2025-08-21

## 项目架构

### 整体架构模式
- **架构类型**: 前后端分离
- **通信方式**: RESTful API + JSON
- **部署模式**: 独立部署 (前端静态资源 + 后端服务)

### 技术选型理由
1. **Rust + Rocket**: 高性能、内存安全、现代化的后端框架
2. **Taro + React**: 一套代码多端运行、生态丰富
3. **JSON API**: 标准化、易于扩展的数据交换格式

## 后端技术栈详情

### 核心框架
```toml
[dependencies]
rocket = { version = "=0.5.0", features = ["json"] }
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
```

### Rocket 特性
- 🚀 **零配置启动**: 自动路由发现
- 🔒 **类型安全**: 编译时保证 API 安全性  
- 📡 **异步支持**: 基于 Tokio 的异步运行时
- 🎯 **请求守卫**: 自动参数验证和转换
- 🛡️ **内置安全**: CSRF、CORS、输入验证

### 可用扩展模块
- **数据库池**: contrib/db_pools (PostgreSQL, MySQL, SQLite)
- **同步数据库**: contrib/sync_db_pools
- **模板引擎**: contrib/dyn_templates (Handlebars, Tera, MiniJinja)
- **WebSocket**: contrib/ws

## 前端技术栈详情

### 核心依赖
```json
{
  "@tarojs/taro": "3.6.23",
  "react": "^18.0.0", 
  "react-dom": "^18.0.0",
  "zustand": "^4.4.0"
}
```

### Taro 平台支持矩阵

| 平台 | 状态 | 构建命令 | 说明 |
|------|------|----------|------|
| H5 | ✅ | `build:h5` | Web 浏览器 |
| 微信小程序 | ✅ | `build:weapp` | 原生小程序 |
| 支付宝小程序 | ✅ | `build:alipay` | 支付宝生态 |
| 字节跳动小程序 | ✅ | `build:tt` | 抖音、今日头条 |
| QQ 小程序 | ✅ | `build:qq` | QQ 平台 |
| 京东小程序 | ✅ | `build:jd` | 京东购物 |
| 百度小程序 | ✅ | `build:swan` | 百度 App |
| React Native | ✅ | `build:rn` | 移动原生应用 |

### 状态管理方案
**Zustand 优势**:
- 轻量级 (2.9KB gzipped)
- TypeScript 友好
- 无需 Provider 包装
- 支持中间件扩展

## 开发工具配置

### 代码质量工具
```json
{
  "eslint": "^8.12.0",
  "eslint-config-taro": "3.6.23", 
  "eslint-plugin-react": "^7.28.0",
  "eslint-plugin-react-hooks": "^4.3.0",
  "stylelint": "14.4.0"
}
```

### 构建工具链
- **打包器**: Webpack 5.78.0
- **转译器**: Babel 7.21.8
- **CSS 处理**: PostCSS 8.4.18
- **样式加载**: css-loader + style-loader

### 浏览器兼容性
```json
{
  "browserslist": [
    "last 3 versions",
    "Android >= 4.4", 
    "ios >= 9"
  ]
}
```

## 项目配置文件

### Rocket 服务器配置
**文件**: `rocket-taro-server/Rocket.toml`
- 端口配置: 默认 8000
- 日志级别: 可配置
- 静态文件服务: 支持前端资源

### Taro 配置
**文件**: `frontend/config/index.js`
- 开发服务器设置
- 构建输出配置
- 平台特定配置

## 环境变量配置

### 后端环境变量
```bash
ROCKET_PORT=8000          # 服务端口
ROCKET_LOG=debug          # 日志级别
ROCKET_ENV=development    # 运行环境
```

### 前端环境变量
```bash
NODE_ENV=development      # 构建模式
TARO_ENV=h5              # 目标平台
```

## 构建和部署配置

### 构建脚本
1. **build-all.bat**: 全量构建
2. **build-frontend.bat**: 前端构建
3. **start-rocket.bat**: 启动后端
4. **start-frontend.bat**: 启动前端开发服务器

### 部署建议
```bash
# 生产构建
cd frontend && npm run build:h5
cd ../rocket-taro-server && cargo build --release

# 启动生产服务器
./target/release/server
```

## 性能优化配置

### 前端优化
- **代码分割**: Webpack 动态导入
- **Tree Shaking**: 移除未使用代码
- **资源压缩**: CSS/JS 压缩
- **缓存策略**: 文件哈希命名

### 后端优化
- **Release 模式**: 编译优化
- **静态文件服务**: 高效文件传输
- **异步处理**: 非阻塞 I/O
- **内存管理**: Rust 零拷贝优化

## 安全配置

### 内置安全特性
- **CORS 支持**: 跨域请求控制
- **输入验证**: Serde 自动验证
- **类型安全**: Rust 编译时检查
- **内存安全**: 无缓冲区溢出

### 推荐安全实践
1. 启用 HTTPS (生产环境)
2. 配置适当的 CORS 策略
3. 实现 JWT 认证
4. 添加请求频率限制

## 扩展建议

### 短期扩展
1. **数据库集成**: 添加 PostgreSQL 支持
2. **认证系统**: JWT + 会话管理
3. **API 文档**: OpenAPI/Swagger 集成
4. **日志系统**: 结构化日志

### 中期扩展
1. **缓存层**: Redis 集成
2. **文件上传**: 支持图片/文档上传
3. **实时通信**: WebSocket 聊天功能
4. **部署自动化**: Docker + CI/CD

### 长期扩展
1. **微服务架构**: 服务拆分
2. **消息队列**: 异步任务处理
3. **监控告警**: 性能监控
4. **多环境部署**: 开发/测试/生产环境

## 总结

当前技术栈配置为快速开发提供了坚实基础，具有以下优势：

**开发效率**: Taro 一套代码多端运行，Rocket 类型安全减少运行时错误  
**性能表现**: Rust 高性能后端，Webpack 5 优化构建  
**扩展性**: 模块化架构，支持渐进式功能添加  
**生态支持**: React 丰富生态，Rocket 活跃社区  

建议按照项目需求逐步添加数据库、认证等核心功能模块。