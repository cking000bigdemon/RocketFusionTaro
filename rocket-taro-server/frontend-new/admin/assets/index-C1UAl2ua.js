const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-CcXXinTU.js","assets/_plugin-vue_export-helper-BwE83l92.js","assets/_plugin-vue_export-helper-mjPzPNV5.css","assets/vue-vendor-CvPKWCuE.js","assets/element-plus-CWGZaCRY.js","assets/Login-C490RPRv.css","assets/el-divider-BUtF_RGI.css","assets/el-input-v7L0Qt8u.css","assets/AdminLayout-DXo8iP_e.js","assets/AdminLayout-Dt1-skGy.css","assets/el-popper-3534tD-7.css","assets/el-menu-item-CZugV5oq.css","assets/el-button-group-ePhtJS9H.css","assets/el-avatar-BmRr_O8d.css","assets/Dashboard-DLkYzUtS.js","assets/charts-axzJldHz.js","assets/Dashboard-CbFUiLw1.css","assets/el-col-Ds2mGN2S.css","assets/el-card-fwQOLwdi.css","assets/Users-fGCWFGk-.js","assets/Users-xbkp8QHo.css","assets/el-table-column-DRkBfr3-.css","assets/el-select-CqCa2H6B.css","assets/UserData-BkS01Orf.js","assets/UserData-Ds13NM7k.css","assets/el-descriptions-item-o9ObloqJ.css","assets/Settings-CbADo1u_.js","assets/Settings-DuNf2P3X.css","assets/NotFound-CJkpuMNh.js","assets/NotFound-BlJdSnpo.css"])))=>i.map(i=>d[i]);
import{r as w,a as E,ag as M,ah as F,c as T,l as j,d as G,m as V,H as J,a8 as K,q as Q,ai as X,aj as Y,ae as Z,ak as ee}from"./vue-vendor-CvPKWCuE.js";import{M as S,O as te,P as re,Q as ne,R as se}from"./element-plus-CWGZaCRY.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=r(i);fetch(i.href,c)}})();const H={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var N={};function z(u,e=""){try{if(typeof window<"u"&&import.meta&&H)return H[u]||e}catch{}return typeof process<"u"&&N?N[u]||e:(typeof wx<"u"&&wx.getSystemInfoSync,e)}function oe(){return z("NODE_ENV","development")==="development"||z("MODE","development")==="development"}class k{constructor(e){this.routerHandler=e,this.baseURL="",this.defaultHeaders={"Content-Type":"application/json"}}setBaseURL(e){this.baseURL=e}setDefaultHeaders(e){this.defaultHeaders={...this.defaultHeaders,...e}}async post(e,r={},o={}){return this.request("POST",e,r,o)}async get(e,r={},o={}){if(Object.keys(r).length>0){const i=new URLSearchParams;Object.entries(r).forEach(([c,d])=>{i.append(c,String(d))}),e+=`?${i.toString()}`}return this.request("GET",e,null,o)}async put(e,r={},o={}){return this.request("PUT",e,r,o)}async delete(e,r={}){return this.request("DELETE",e,null,r)}async request(e,r,o=null,i={}){var p;const c=this.buildFullURL(r),d={method:e,headers:{...this.defaultHeaders,...i.headers},...i};o&&(e==="POST"||e==="PUT")&&(d.body=JSON.stringify(o));try{const m=await fetch(c,d);if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const y=await m.json();return await this.handleRouteCommand(y),y}catch(m){throw console.error("Request failed:",m),i.showErrorToast!==!1&&await((p=this.routerHandler)==null?void 0:p.showGenericError()),m}}async handleRouteCommand(e){if(!(!e||!e.route_command)){if(!this.routerHandler){oe()&&console.log("RequestInterceptor: B-end mode - skipping route command execution (expected behavior)");return}try{await this.routerHandler.execute(e.route_command)}catch(r){console.error("RequestInterceptor: Route command execution failed:",r)}}}buildFullURL(e){if(e.startsWith("http://")||e.startsWith("https://"))return e;const r=this.baseURL.endsWith("/")?this.baseURL.slice(0,-1):this.baseURL,o=e.startsWith("/")?e:`/${e}`;return`${r}${o}`}addRequestInterceptor(e){this.requestInterceptor=e}addResponseInterceptor(e){this.responseInterceptor=e}setAuthToken(e){e?this.defaultHeaders.Authorization=`Bearer ${e}`:delete this.defaultHeaders.Authorization}setSessionId(e){e?this.defaultHeaders["Session-ID"]=e:delete this.defaultHeaders["Session-ID"]}}class x{constructor(e=null){this.mobileInterceptor=new k(e),this.mobileInterceptor.setBaseURL("/api"),this.adminInterceptor=new k(null),this.adminInterceptor.setBaseURL("/api"),this.publicInterceptor=new k(null),this.publicInterceptor.setBaseURL("/api/public")}setRouterHandler(e){this.mobileInterceptor=new k(e),this.mobileInterceptor.setBaseURL("/api")}async mobileLogin(e){return this.mobileInterceptor.post("/auth/login",e)}async mobileLogout(){return this.mobileInterceptor.post("/auth/logout")}async mobileGetUserInfo(){return this.mobileInterceptor.get("/user/info")}async mobileUpdateUserInfo(e){return this.mobileInterceptor.put("/user/info",e)}async mobileGetUserData(e={}){return this.mobileInterceptor.get("/user/data",e)}async mobileAddUserData(e){return this.mobileInterceptor.post("/user/data",e)}async mobileUpdateUserData(e,r){return this.mobileInterceptor.put(`/user/data/${e}`,r)}async mobileDeleteUserData(e){return this.mobileInterceptor.delete(`/user/data/${e}`)}async adminLogin(e){return this.adminInterceptor.post("/auth/login",e)}async adminLogout(){return this.adminInterceptor.post("/auth/logout")}async adminGetUserList(e={}){return this.adminInterceptor.get("/users",e)}async adminCreateUser(e){return this.adminInterceptor.post("/users",e)}async adminUpdateUser(e,r){return this.adminInterceptor.put(`/users/${e}`,r)}async adminDeleteUser(e){return this.adminInterceptor.delete(`/users/${e}`)}async adminGetSystemStats(){return this.adminInterceptor.get("/system/stats")}async adminGetUserDataList(e={}){return this.adminInterceptor.get("/user-data",e)}async getHealthStatus(){return this.publicInterceptor.get("/health")}async getSystemConfig(){return this.publicInterceptor.get("/config")}async reportError(e){return this.publicInterceptor.post("/error/report",e)}async reportRouteCommandMetrics(e){return this.publicInterceptor.post("/metrics/route-command-error",e)}setMobileAuth(e){this.mobileInterceptor.setAuthToken(e)}setAdminAuth(e){this.adminInterceptor.setAuthToken(e)}clearAuth(){this.mobileInterceptor.setAuthToken(null),this.adminInterceptor.setAuthToken(null)}getMobileInterceptor(){return this.mobileInterceptor}getAdminInterceptor(){return this.adminInterceptor}getPublicInterceptor(){return this.publicInterceptor}}new x;let R=null;function D(){const u=w(!1),e=()=>(R||(R=new x(null),u.value=!0),R),r=()=>{if(!R)throw new Error("API Client not initialized. Call initializeApiClient() first.");return R};return{apiClient:R||e(),initialized:E(u),initializeApiClient:e,getApiClient:r}}const W=M("auth",()=>{const{apiClient:u}=D(),e=F(),r=w(null),o=w(null),i=w(!1),c=T(()=>!!r.value&&!!o.value),d=T(()=>{var t;return((t=r.value)==null?void 0:t.is_admin)||!1}),p=async()=>{const t=localStorage.getItem("admin_token");if(t){o.value=t,u.setAdminAuth(t);try{await v()}catch(s){console.error("Failed to restore auth state:",s),b()}}},m=async t=>{var s,a;i.value=!0;try{const l=await u.adminLogin({username:t.username,password:t.password,remember_me:t.remember_me});if(l.code===200&&l.data){o.value=l.data.session_token,r.value=l.data.user,t.remember_me?localStorage.setItem("admin_token",l.data.session_token):sessionStorage.setItem("admin_token",l.data.session_token),S.success("登录成功");const f=e.currentRoute.value.query.redirect;return await e.push(f||"/dashboard"),{success:!0}}else return S.error(l.message||"登录失败"),{success:!1,message:l.message}}catch(l){console.error("Login failed:",l);const f=((a=(s=l.response)==null?void 0:s.data)==null?void 0:a.message)||l.message||"登录失败，请重试";return S.error(f),{success:!1,message:f}}finally{i.value=!1}},y=async(t=!0)=>{i.value=!0;try{o.value&&await u.adminLogout()}catch(s){console.error("Logout request failed:",s)}finally{b(),t&&S.success("已成功登出"),await e.push("/login"),i.value=!1}},v=async()=>{if(!o.value)throw new Error("No token available");try{const t=await u.getAdminInterceptor().get("/auth/me");if(t.code===200&&t.data)return r.value=t.data,t.data;throw new Error(t.message||"Failed to fetch user info")}catch(t){throw console.error("Failed to fetch user info:",t),t}},g=t=>{r.value&&(r.value={...r.value,...t})},b=()=>{r.value=null,o.value=null,localStorage.removeItem("admin_token"),sessionStorage.removeItem("admin_token"),u.setAdminAuth(null)},A=t=>r.value?!!r.value.is_admin:!1;return{user:E(r),token:E(o),loading:E(i),isAuthenticated:c,isAdmin:d,initializeAuth:p,login:m,logout:y,fetchUserInfo:v,updateUserInfo:g,clearAuth:b,hasPermission:A}}),ie=M("app",()=>{const{apiClient:u}=D(),e=w(null),r=w(null),o=w(!1),i=w(!1),c=w("light"),d=T(()=>c.value==="dark"),p=T(()=>r.value?r.value.database_status==="connected"&&r.value.redis_status==="connected":!1),m=async()=>{o.value=!0;try{await Promise.allSettled([v(),y()]);const n=localStorage.getItem("admin_theme");n&&g(n);const h=localStorage.getItem("admin_sidebar_collapsed");h!==null&&(i.value=JSON.parse(h))}catch(n){console.error("Failed to initialize app:",n)}finally{o.value=!1}},y=async()=>{try{const n=await u.adminGetSystemStats();return n.code===200&&n.data?(e.value=n.data,n.data):(console.error("Failed to fetch system stats:",n.message),null)}catch(n){return console.error("Failed to fetch system stats:",n),null}},v=async()=>{try{const n=await u.getSystemConfig();return n.code===200&&n.data?(r.value=n.data,n.data):(console.error("Failed to fetch system config:",n.message),null)}catch(n){return console.error("Failed to fetch system config:",n),null}},g=n=>{c.value=n;const h=document.documentElement;n==="dark"?h.classList.add("dark"):h.classList.remove("dark"),localStorage.setItem("admin_theme",n)},b=()=>{g(c.value==="light"?"dark":"light")},A=()=>{i.value=!i.value,localStorage.setItem("admin_sidebar_collapsed",JSON.stringify(i.value))},t=n=>{i.value=n,localStorage.setItem("admin_sidebar_collapsed",JSON.stringify(n))},s=n=>{S.success(n)},a=n=>{S.error(n)},l=n=>{S.warning(n)},f=n=>{S.info(n)},_=async()=>{const n=S({message:"正在刷新系统数据...",type:"info",duration:0});try{await Promise.all([v(),y()]),n.close(),S.success("系统数据已刷新")}catch{n.close(),S.error("刷新系统数据失败")}};return{systemStats:E(e),systemConfig:E(r),loading:E(o),sidebarCollapsed:E(i),theme:E(c),isDarkTheme:d,systemHealthy:p,initialize:m,fetchSystemStats:y,fetchSystemConfig:v,setTheme:g,toggleTheme:b,toggleSidebar:A,setSidebarCollapsed:t,showSuccess:s,showError:a,showWarning:l,showInfo:f,refreshSystemData:_}}),ae={id:"app",class:"app-container"},ce=j({__name:"App",setup(u){const e=W(),r=ie();return G(async()=>{await r.initialize(),await e.initializeAuth()}),(o,i)=>{const c=K("router-view");return Q(),V("div",ae,[J(c)])}}}),ue="modulepreload",le=function(u){return"/"+u},B={},P=function(e,r,o){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));i=Promise.allSettled(r.map(m=>{if(m=le(m),m in B)return;B[m]=!0;const y=m.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${v}`))return;const g=document.createElement("link");if(g.rel=y?"stylesheet":ue,y||(g.as="script"),g.crossOrigin="",g.href=m,p&&g.setAttribute("nonce",p),document.head.appendChild(g),y)return new Promise((b,A)=>{g.addEventListener("load",b),g.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function c(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return i.then(d=>{for(const p of d||[])p.status==="rejected"&&c(p.reason);return e().catch(c)})};var $={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(u,e){(function(r,o){u.exports=o()})(te,function(){var r={};r.version="0.2.0";var o=r.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};r.configure=function(t){var s,a;for(s in t)a=t[s],a!==void 0&&t.hasOwnProperty(s)&&(o[s]=a);return this},r.status=null,r.set=function(t){var s=r.isStarted();t=i(t,o.minimum,1),r.status=t===1?null:t;var a=r.render(!s),l=a.querySelector(o.barSelector),f=o.speed,_=o.easing;return a.offsetWidth,p(function(n){o.positionUsing===""&&(o.positionUsing=r.getPositioningCSS()),m(l,d(t,f,_)),t===1?(m(a,{transition:"none",opacity:1}),a.offsetWidth,setTimeout(function(){m(a,{transition:"all "+f+"ms linear",opacity:0}),setTimeout(function(){r.remove(),n()},f)},f)):setTimeout(n,f)}),this},r.isStarted=function(){return typeof r.status=="number"},r.start=function(){r.status||r.set(0);var t=function(){setTimeout(function(){r.status&&(r.trickle(),t())},o.trickleSpeed)};return o.trickle&&t(),this},r.done=function(t){return!t&&!r.status?this:r.inc(.3+.5*Math.random()).set(1)},r.inc=function(t){var s=r.status;return s?(typeof t!="number"&&(t=(1-s)*i(Math.random()*s,.1,.95)),s=i(s+t,0,.994),r.set(s)):r.start()},r.trickle=function(){return r.inc(Math.random()*o.trickleRate)},function(){var t=0,s=0;r.promise=function(a){return!a||a.state()==="resolved"?this:(s===0&&r.start(),t++,s++,a.always(function(){s--,s===0?(t=0,r.done()):r.set((t-s)/t)}),this)}}(),r.render=function(t){if(r.isRendered())return document.getElementById("nprogress");v(document.documentElement,"nprogress-busy");var s=document.createElement("div");s.id="nprogress",s.innerHTML=o.template;var a=s.querySelector(o.barSelector),l=t?"-100":c(r.status||0),f=document.querySelector(o.parent),_;return m(a,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),o.showSpinner||(_=s.querySelector(o.spinnerSelector),_&&A(_)),f!=document.body&&v(f,"nprogress-custom-parent"),f.appendChild(s),s},r.remove=function(){g(document.documentElement,"nprogress-busy"),g(document.querySelector(o.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&A(t)},r.isRendered=function(){return!!document.getElementById("nprogress")},r.getPositioningCSS=function(){var t=document.body.style,s="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return s+"Perspective"in t?"translate3d":s+"Transform"in t?"translate":"margin"};function i(t,s,a){return t<s?s:t>a?a:t}function c(t){return(-1+t)*100}function d(t,s,a){var l;return o.positionUsing==="translate3d"?l={transform:"translate3d("+c(t)+"%,0,0)"}:o.positionUsing==="translate"?l={transform:"translate("+c(t)+"%,0)"}:l={"margin-left":c(t)+"%"},l.transition="all "+s+"ms "+a,l}var p=function(){var t=[];function s(){var a=t.shift();a&&a(s)}return function(a){t.push(a),t.length==1&&s()}}(),m=function(){var t=["Webkit","O","Moz","ms"],s={};function a(n){return n.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(h,I){return I.toUpperCase()})}function l(n){var h=document.body.style;if(n in h)return n;for(var I=t.length,U=n.charAt(0).toUpperCase()+n.slice(1),L;I--;)if(L=t[I]+U,L in h)return L;return n}function f(n){return n=a(n),s[n]||(s[n]=l(n))}function _(n,h,I){h=f(h),n.style[h]=I}return function(n,h){var I=arguments,U,L;if(I.length==2)for(U in h)L=h[U],L!==void 0&&h.hasOwnProperty(U)&&_(n,U,L);else _(n,I[1],I[2])}}();function y(t,s){var a=typeof t=="string"?t:b(t);return a.indexOf(" "+s+" ")>=0}function v(t,s){var a=b(t),l=a+s;y(a,s)||(t.className=l.substring(1))}function g(t,s){var a=b(t),l;y(t,s)&&(l=a.replace(" "+s+" "," "),t.className=l.substring(1,l.length-1))}function b(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")}function A(t){t&&t.parentNode&&t.parentNode.removeChild(t)}return r})})($);var de=$.exports;const O=re(de);O.configure({showSpinner:!1,minimum:.2,speed:500});const me=[{path:"/login",name:"Login",component:()=>P(()=>import("./Login-CcXXinTU.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),meta:{title:"登录",requiresAuth:!1,hideInMenu:!0}},{path:"/",redirect:"/dashboard",component:()=>P(()=>import("./AdminLayout-DXo8iP_e.js"),__vite__mapDeps([8,1,2,3,4,9,10,11,12,13])),meta:{requiresAuth:!0},children:[{path:"dashboard",name:"Dashboard",component:()=>P(()=>import("./Dashboard-DLkYzUtS.js"),__vite__mapDeps([14,1,2,15,3,4,16,13,17,12,18])),meta:{title:"仪表板",icon:"Odometer",requiresAuth:!0}},{path:"users",name:"Users",component:()=>P(()=>import("./Users-fGCWFGk-.js"),__vite__mapDeps([19,1,2,3,4,20,21,22,10,7,12,13,18])),meta:{title:"用户管理",icon:"User",requiresAuth:!0}},{path:"user-data",name:"UserData",component:()=>P(()=>import("./UserData-BkS01Orf.js"),__vite__mapDeps([23,1,2,3,4,24,21,6,25,22,10,7,12,18])),meta:{title:"用户数据",icon:"DataAnalysis",requiresAuth:!0}},{path:"settings",name:"Settings",component:()=>P(()=>import("./Settings-CbADo1u_.js"),__vite__mapDeps([26,1,2,3,4,27,17,7,10,25,22,18,11])),meta:{title:"系统设置",icon:"Setting",requiresAuth:!0}}]},{path:"/:pathMatch(.*)*",name:"NotFound",component:()=>P(()=>import("./NotFound-CJkpuMNh.js"),__vite__mapDeps([28,1,2,3,4,29])),meta:{title:"页面不存在",hideInMenu:!0}}],q=X({history:Y("/"),routes:me,scrollBehavior(u,e,r){return r||{top:0}}});q.beforeEach(async(u,e,r)=>{var c,d;O.start();const o=(c=u.meta)==null?void 0:c.title;o&&(document.title=`${o} - Rocket 管理后台`);const i=W();if(((d=u.meta)==null?void 0:d.requiresAuth)!==!1){if(!i.isAuthenticated){r({path:"/login",query:{redirect:u.fullPath}});return}}else if(u.name==="Login"&&i.isAuthenticated){r({path:"/dashboard"});return}r()});q.afterEach(()=>{O.done()});q.onError(u=>{console.error("Router Error:",u),O.done()});const C=Z(ce);C.use(ee());C.use(ne);for(const[u,e]of Object.entries(se))C.component(u,e);C.use(q);const{initializeApiClient:pe}=D();pe();C.mount("#app");export{ie as a,D as b,W as u};
