import{c as I,u as y,n as A,d as L,e as z,m as M,t as B,r as C,a as S,b as c,I as q,f as V,g as N,w as G,h as U,i as F,p as O,j as D,k as E,l as R,o as T,q as j,s as H,v as K,x as J,y as W,z as X,A as r,B as x,C as P,D as Y,E as w}from"./index-acb3025e.js";import{_ as Q}from"./_plugin-vue_export-helper-a85ffdf4.js";import{C as Z}from"./index-77ab8702.js";import{F as ee}from"./index-2cf87b80.js";import{F as oe}from"./index-29525019.js";const[ae,Ve]=I("checkbox-group"),te=Symbol(ae),$={name:y,disabled:Boolean,iconSize:A,modelValue:y,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var ne=L({props:z({},$,{bem:M(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:B,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(o,{emit:b,slots:p}){const u=C(),m=e=>{if(o.parent&&o.bindGroup)return o.parent.props[e]},a=S(()=>{if(o.parent&&o.bindGroup){const e=m("disabled")||o.disabled;if(o.role==="checkbox"){const n=m("modelValue").length,s=m("max"),d=s&&n>=+s;return e||d&&!o.checked}return e}return o.disabled}),_=S(()=>m("direction")),i=S(()=>{const e=o.checkedColor||m("checkedColor");if(e&&(o.checked||o.indeterminate)&&!a.value)return{borderColor:e,backgroundColor:e}}),f=S(()=>o.shape||m("shape")||"round"),k=e=>{const{target:n}=e,s=u.value,d=s===n||(s==null?void 0:s.contains(n));!a.value&&(d||!o.labelDisabled)&&b("toggle"),b("click",e)},h=()=>{var e,n;const{bem:s,checked:d,indeterminate:g}=o,l=o.iconSize||m("iconSize");return c("div",{ref:u,class:s("icon",[f.value,{disabled:a.value,checked:d,indeterminate:g}]),style:f.value!=="dot"?{fontSize:V(l)}:{width:V(l),height:V(l),borderColor:(e=i.value)==null?void 0:e.borderColor}},[p.icon?p.icon({checked:d,disabled:a.value}):f.value!=="dot"?c(q,{name:g?"minus":"success",style:i.value},null):c("div",{class:s("icon--dot__icon"),style:{backgroundColor:(n=i.value)==null?void 0:n.backgroundColor}},null)])},t=()=>{const{checked:e}=o;if(p.default)return c("span",{class:o.bem("label",[o.labelPosition,{disabled:a.value}])},[p.default({checked:e,disabled:a.value})])};return()=>{const e=o.labelPosition==="left"?[t(),h()]:[h(),t()];return c("div",{role:o.role,class:o.bem([{disabled:a.value,"label-disabled":o.labelDisabled},_.value]),tabindex:a.value?void 0:0,"aria-checked":o.checked,onClick:k},[e])}}});const[se,le]=I("checkbox"),re=z({},$,{shape:String,bindGroup:B,indeterminate:{type:Boolean,default:null}});var ie=L({name:se,props:re,emits:["change","update:modelValue"],setup(o,{emit:b,slots:p}){const{parent:u}=N(te),m=i=>{const{name:f}=o,{max:k,modelValue:h}=u.props,t=h.slice();if(i)!(k&&t.length>=+k)&&!t.includes(f)&&(t.push(f),o.bindGroup&&u.updateValue(t));else{const e=t.indexOf(f);e!==-1&&(t.splice(e,1),o.bindGroup&&u.updateValue(t))}},a=S(()=>u&&o.bindGroup?u.props.modelValue.indexOf(o.name)!==-1:!!o.modelValue),_=(i=!a.value)=>{u&&o.bindGroup?m(i):b("update:modelValue",i),o.indeterminate!==null&&b("change",i)};return G(()=>o.modelValue,i=>{o.indeterminate===null&&b("change",i)}),U({toggle:_,props:o,checked:a}),F(()=>o.modelValue),()=>c(ne,D({bem:le,role:"checkbox",parent:u,checked:a.value,onToggle:_},o),O(p,["default","icon"]))}});const de=E(ie);const ce={class:"login-page"},ue={class:"login-form"},me={class:"login-options"},fe={class:"login-button"},ge={class:"quick-login"},ve={class:"quick-buttons"},be={class:"login-footer"},pe={class:"version"},_e={class:"platform"},ke={__name:"Login",setup(o){const b=R("apiClient"),p=T(),u=j(),m=C(!1),a=H({username:"",password:"",rememberMe:!1}),_=C("1.0.0"),i=C(""),f=K();async function k(){var t,e,n,s,d,g;if(!a.username||!a.password){await f.platformAdapter.showToast("请填写完整的登录信息","error");return}m.value=!0;try{const l=await b.mobileLogin({username:a.username.trim(),password:a.password,remember_me:a.rememberMe});console.log("Login API called successfully:",l),(t=l.data)!=null&&t.session_token&&localStorage.setItem("auth_token",l.data.session_token),(e=l.data)!=null&&e.user&&localStorage.setItem("user_info",JSON.stringify(l.data.user)),console.log("✅ Auth data saved:",{token:!!((n=l.data)!=null&&n.session_token),user:!!((s=l.data)!=null&&s.user)})}catch(l){console.error("Login failed:",l);const v=((g=(d=l.response)==null?void 0:d.data)==null?void 0:g.message)||"登录失败，请重试";await f.platformAdapter.showToast(v,"error")}finally{m.value=!1}}async function h(t){const n={admin:{username:"admin",password:"password"},test:{username:"test",password:"password"}}[t];n&&(a.username=n.username,a.password=n.password,await k())}return J(async()=>{const t=u.getAppInfo();_.value=t.version;const e=f.platformAdapter.getPlatformInfo();i.value=`${e.platform} - ${e.screenSize.width}x${e.screenSize.height}`;const n=localStorage.getItem("saved_username");n&&u.settings.autoLogin&&(a.username=n,a.rememberMe=!0);const s=sessionStorage.getItem("redirectPath");if(s&&console.log("Will redirect to:",s,"after login"),p.isLoggedIn){const d=sessionStorage.getItem("redirectPath");sessionStorage.removeItem("redirectPath"),d?await f.smartNavigate(d,{replace:!0}):await f.smartNavigate("/home",{replace:!0})}}),G(()=>a.rememberMe,t=>{t&&a.username?localStorage.setItem("saved_username",a.username):t||localStorage.removeItem("saved_username")}),(t,e)=>{const n=ee,s=Z,d=de,g=Y,l=oe;return W(),X("div",ce,[e[10]||(e[10]=r("div",{class:"login-header"},[r("div",{class:"logo"},[r("div",{class:"logo-text"},"🚀 Rocket")]),r("div",{class:"welcome-text"},[r("h1",null,"欢迎使用"),r("p",null,"请登录您的账户")])],-1)),r("div",ue,[c(l,{onSubmit:k},{default:x(()=>[c(s,{inset:""},{default:x(()=>[c(n,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=v=>a.username=v),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"}],"left-icon":"user-o",clearable:""},null,8,["modelValue"]),c(n,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=v=>a.password=v),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}],"left-icon":"lock",clearable:""},null,8,["modelValue"])]),_:1}),r("div",me,[c(d,{modelValue:a.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=v=>a.rememberMe=v)},{default:x(()=>[...e[5]||(e[5]=[w("记住密码",-1)])]),_:1},8,["modelValue"])]),r("div",fe,[c(g,{round:"",block:"",type:"primary","native-type":"submit",loading:m.value,"loading-text":"登录中...",size:"large"},{default:x(()=>[...e[6]||(e[6]=[w(" 登录 ",-1)])]),_:1},8,["loading"])])]),_:1}),r("div",ge,[e[9]||(e[9]=r("div",{class:"divider"},[r("span",null,"或")],-1)),r("div",ve,[c(g,{plain:"",round:"",size:"large",onClick:e[3]||(e[3]=v=>h("admin"))},{default:x(()=>[...e[7]||(e[7]=[w(" 管理员登录 ",-1)])]),_:1}),c(g,{plain:"",round:"",size:"large",onClick:e[4]||(e[4]=v=>h("test"))},{default:x(()=>[...e[8]||(e[8]=[w(" 测试账号登录 ",-1)])]),_:1})])])]),r("div",be,[r("p",pe,"版本 v"+P(_.value),1),r("p",_e,P(i.value),1)])])}}},ye=Q(ke,[["__scopeId","data-v-dd55c080"]]);export{ye as default};
