import{c as y,u as V,n as $,d as I,e as L,m as M,t as z,r as S,a as k,b as u,I as q,f as C,g as A,w as B,h as U,i as F,p as N,j as D,k as E,l as O,o as R,q as T,s as H,v as j,x as K,y as W,z as r,A as h,B as P,C as X,D as Y,E as w}from"./index-6d716dcb.js";import{_ as J}from"./_plugin-vue_export-helper-a85ffdf4.js";import{C as Q}from"./index-db517800.js";import{F as Z}from"./index-b73ae9b8.js";import{F as ee}from"./index-15eae749.js";const[oe,Ce]=y("checkbox-group"),ae=Symbol(oe),G={name:V,disabled:Boolean,iconSize:$,modelValue:V,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var te=I({props:L({},G,{bem:M(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:z,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(o,{emit:b,slots:v}){const c=S(),t=a=>{if(o.parent&&o.bindGroup)return o.parent.props[a]},i=k(()=>{if(o.parent&&o.bindGroup){const a=t("disabled")||o.disabled;if(o.role==="checkbox"){const n=t("modelValue").length,l=t("max"),g=l&&n>=+l;return a||g&&!o.checked}return a}return o.disabled}),p=k(()=>t("direction")),s=k(()=>{const a=o.checkedColor||t("checkedColor");if(a&&(o.checked||o.indeterminate)&&!i.value)return{borderColor:a,backgroundColor:a}}),f=k(()=>o.shape||t("shape")||"round"),_=a=>{const{target:n}=a,l=c.value,g=l===n||(l==null?void 0:l.contains(n));!i.value&&(g||!o.labelDisabled)&&b("toggle"),b("click",a)},d=()=>{var a,n;const{bem:l,checked:g,indeterminate:x}=o,m=o.iconSize||t("iconSize");return u("div",{ref:c,class:l("icon",[f.value,{disabled:i.value,checked:g,indeterminate:x}]),style:f.value!=="dot"?{fontSize:C(m)}:{width:C(m),height:C(m),borderColor:(a=s.value)==null?void 0:a.borderColor}},[v.icon?v.icon({checked:g,disabled:i.value}):f.value!=="dot"?u(q,{name:x?"minus":"success",style:s.value},null):u("div",{class:l("icon--dot__icon"),style:{backgroundColor:(n=s.value)==null?void 0:n.backgroundColor}},null)])},e=()=>{const{checked:a}=o;if(v.default)return u("span",{class:o.bem("label",[o.labelPosition,{disabled:i.value}])},[v.default({checked:a,disabled:i.value})])};return()=>{const a=o.labelPosition==="left"?[e(),d()]:[d(),e()];return u("div",{role:o.role,class:o.bem([{disabled:i.value,"label-disabled":o.labelDisabled},p.value]),tabindex:i.value?void 0:0,"aria-checked":o.checked,onClick:_},[a])}}});const[ne,se]=y("checkbox"),le=L({},G,{shape:String,bindGroup:z,indeterminate:{type:Boolean,default:null}});var re=I({name:ne,props:le,emits:["change","update:modelValue"],setup(o,{emit:b,slots:v}){const{parent:c}=A(ae),t=s=>{const{name:f}=o,{max:_,modelValue:d}=c.props,e=d.slice();if(s)!(_&&e.length>=+_)&&!e.includes(f)&&(e.push(f),o.bindGroup&&c.updateValue(e));else{const a=e.indexOf(f);a!==-1&&(e.splice(a,1),o.bindGroup&&c.updateValue(e))}},i=k(()=>c&&o.bindGroup?c.props.modelValue.indexOf(o.name)!==-1:!!o.modelValue),p=(s=!i.value)=>{c&&o.bindGroup?t(s):b("update:modelValue",s),o.indeterminate!==null&&b("change",s)};return B(()=>o.modelValue,s=>{o.indeterminate===null&&b("change",s)}),U({toggle:p,props:o,checked:i}),F(()=>o.modelValue),()=>u(te,D({bem:se,role:"checkbox",parent:c,checked:i.value,onToggle:p},o),N(v,["default","icon"]))}});const ie=E(re);const de={class:"login-page"},ce={class:"login-form"},ue={class:"login-options"},me={class:"login-button"},fe={class:"quick-login"},ge={class:"quick-buttons"},ve={class:"login-footer"},be={class:"version"},pe={class:"platform"},_e={__name:"Login",setup(o){const b=O(),v=R(),c=S(!1),t=T({username:"",password:"",rememberMe:!1}),i=S("1.0.0"),p=S(""),s=H();async function f(){var d,e,a;if(!t.username||!t.password){await s.platformAdapter.showToast("请填写完整的登录信息","error");return}c.value=!0;try{const n=await X.mobileLogin({username:t.username.trim(),password:t.password,remember_me:t.rememberMe});console.log("Login API called successfully:",n),(d=n.data)!=null&&d.session_token&&localStorage.setItem("auth_token",n.data.session_token)}catch(n){console.error("Login failed:",n);const l=((a=(e=n.response)==null?void 0:e.data)==null?void 0:a.message)||"登录失败，请重试";await s.platformAdapter.showToast(l,"error")}finally{c.value=!1}}async function _(d){const a={admin:{username:"admin",password:"password"},test:{username:"test",password:"password"}}[d];a&&(t.username=a.username,t.password=a.password,await f())}return j(async()=>{const d=v.getAppInfo();i.value=d.version;const e=s.platformAdapter.getPlatformInfo();p.value=`${e.platform} - ${e.screenSize.width}x${e.screenSize.height}`;const a=localStorage.getItem("saved_username");a&&v.settings.autoLogin&&(t.username=a,t.rememberMe=!0);const n=sessionStorage.getItem("redirectPath");if(n&&console.log("Will redirect to:",n,"after login"),b.isLoggedIn){const l=sessionStorage.getItem("redirectPath");sessionStorage.removeItem("redirectPath"),l?await s.smartNavigate(l,{replace:!0}):await s.smartNavigate("/home",{replace:!0})}}),B(()=>t.rememberMe,d=>{d&&t.username?localStorage.setItem("saved_username",t.username):d||localStorage.removeItem("saved_username")}),(d,e)=>{const a=Z,n=Q,l=ie,g=Y,x=ee;return K(),W("div",de,[e[10]||(e[10]=r("div",{class:"login-header"},[r("div",{class:"logo"},[r("div",{class:"logo-text"},"🚀 Rocket")]),r("div",{class:"welcome-text"},[r("h1",null,"欢迎使用"),r("p",null,"请登录您的账户")])],-1)),r("div",ce,[u(x,{onSubmit:f},{default:h(()=>[u(n,{inset:""},{default:h(()=>[u(a,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=m=>t.username=m),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"}],"left-icon":"user-o",clearable:""},null,8,["modelValue"]),u(a,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=m=>t.password=m),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}],"left-icon":"lock",clearable:""},null,8,["modelValue"])]),_:1}),r("div",ue,[u(l,{modelValue:t.rememberMe,"onUpdate:modelValue":e[2]||(e[2]=m=>t.rememberMe=m)},{default:h(()=>[...e[5]||(e[5]=[w("记住密码",-1)])]),_:1},8,["modelValue"])]),r("div",me,[u(g,{round:"",block:"",type:"primary","native-type":"submit",loading:c.value,"loading-text":"登录中...",size:"large"},{default:h(()=>[...e[6]||(e[6]=[w(" 登录 ",-1)])]),_:1},8,["loading"])])]),_:1}),r("div",fe,[e[9]||(e[9]=r("div",{class:"divider"},[r("span",null,"或")],-1)),r("div",ge,[u(g,{plain:"",round:"",size:"large",onClick:e[3]||(e[3]=m=>_("admin"))},{default:h(()=>[...e[7]||(e[7]=[w(" 管理员登录 ",-1)])]),_:1}),u(g,{plain:"",round:"",size:"large",onClick:e[4]||(e[4]=m=>_("test"))},{default:h(()=>[...e[8]||(e[8]=[w(" 测试账号登录 ",-1)])]),_:1})])])]),r("div",ve,[r("p",be,"版本 v"+P(i.value),1),r("p",pe,P(p.value),1)])])}}},Ve=J(_e,[["__scopeId","data-v-e33697cc"]]);export{Ve as default};
