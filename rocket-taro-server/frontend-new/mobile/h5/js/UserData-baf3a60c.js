import{l as P,c as E,M as N,N as F,t as R,d as j,r as m,O as H,a as I,w as C,P as q,x as D,h as O,Q as z,b as o,R as G,S as U,T as M,U as $,k as J,v as K,s as Q,y as V,z as B,B as p,A as W,F as S,G as Y,J as X,V as Z,I as ee,W as te,H as ae,E as oe,C as ne}from"./index-f619fded.js";import{N as le,f as se,T as re}from"./index-68210b84.js";/* empty css              */import{F as ie,C as de}from"./index-8c0e0b97.js";import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import{F as ue}from"./index-ae6f55cc.js";const fe=Symbol(),me=()=>P(fe,null),[_e,h,ve]=E("list"),ge={error:Boolean,offset:N(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:F("down"),loadingText:String,finishedText:String,immediateCheck:R};var pe=j({name:_e,props:ge,emits:["load","update:error","update:loading"],setup(e,{emit:u,slots:s}){const i=m(e.loading),_=m(),v=m(),n=me(),y=H(_),g=I(()=>e.scroller||y.value),d=()=>{G(()=>{if(i.value||e.finished||e.disabled||e.error||(n==null?void 0:n.value)===!1)return;const{direction:l}=e,f=+e.offset,c=U(g);if(!c.height||M(_))return;let x=!1;const b=U(v);l==="up"?x=c.top-b.top<=f:x=b.bottom-c.bottom<=f,x&&(i.value=!0,u("update:loading",!0),u("load"))})},T=()=>{if(e.finished){const l=s.finished?s.finished():e.finishedText;if(l)return o("div",{class:h("finished-text")},[l])}},k=()=>{u("update:error",!1),d()},r=()=>{if(e.error){const l=s.error?s.error():e.errorText;if(l)return o("div",{role:"button",class:h("error-text"),tabindex:0,onClick:k},[l])}},a=()=>{if(i.value&&!e.finished&&!e.disabled)return o("div",{class:h("loading")},[s.loading?s.loading():o($,{class:h("loading-icon")},{default:()=>[e.loadingText||ve("loading")]})])};return C(()=>[e.loading,e.finished,e.error],d),n&&C(n,l=>{l&&d()}),q(()=>{i.value=e.loading}),D(()=>{e.immediateCheck&&d()}),O({check:d}),z("scroll",d,{target:g,passive:!0}),()=>{var l;const f=(l=s.default)==null?void 0:l.call(s),c=o("div",{ref:v,class:h("placeholder")},null);return o("div",{ref:_,role:"feed",class:h(),"aria-busy":i.value},[e.direction==="down"?f:c,a(),T(),r(),e.direction==="up"?f:c])}}});const he=J(pe);const xe={class:"user-data-page"},be={class:"user-data-content"},we={__name:"UserData",setup(e){const u=K(),s=m([]),i=m(!1),_=m(!1),v=m(!1),n=Q({name:"",description:"",data_type:"",content:""});function y(){u.platformAdapter.goBack()}async function g(){const r=await S.mobileGetUserData();r.data&&(s.value=r.data),i.value=!1,_.value=!0}function d(r){console.log("View detail:",r)}function T(r){return{text:"primary",json:"success",image:"warning",file:"default"}[r]||"default"}async function k(){try{await S.mobileAddUserData(n),Object.assign(n,{name:"",description:"",data_type:"",content:""}),await g(),await u.platformAdapter.showToast("添加成功","success")}catch{await u.platformAdapter.showToast("添加失败","error")}}return D(()=>{g()}),(r,a)=>{const l=ee,f=le,c=re,x=de,b=he,w=ie,A=ue,L=Y;return V(),B("div",xe,[o(f,{title:"我的数据","left-text":"返回","left-arrow":"",onClickLeft:y},{right:p(()=>[o(l,{name:"add-o",onClick:a[0]||(a[0]=t=>v.value=!0)})]),_:1}),W("div",be,[o(b,{loading:i.value,"onUpdate:loading":a[1]||(a[1]=t=>i.value=t),finished:_.value,"finished-text":"没有更多了",onLoad:g},{default:p(()=>[(V(!0),B(X,null,Z(s.value,t=>(V(),te(x,{key:t.id,title:t.name,label:t.description,value:ae(se)(t.created_at),"is-link":"",onClick:ye=>d(t)},{"right-icon":p(()=>[o(c,{size:"mini",type:T(t.data_type)},{default:p(()=>[oe(ne(t.data_type),1)]),_:2},1032,["type"])]),_:2},1032,["title","label","value","onClick"]))),128))]),_:1},8,["loading","finished"])]),o(L,{show:v.value,"onUpdate:show":a[6]||(a[6]=t=>v.value=t),title:"添加数据","show-cancel-button":"",onConfirm:k},{default:p(()=>[o(A,null,{default:p(()=>[o(w,{modelValue:n.name,"onUpdate:modelValue":a[2]||(a[2]=t=>n.name=t),label:"名称",placeholder:"请输入数据名称",required:""},null,8,["modelValue"]),o(w,{modelValue:n.description,"onUpdate:modelValue":a[3]||(a[3]=t=>n.description=t),label:"描述",placeholder:"请输入描述（可选）"},null,8,["modelValue"]),o(w,{modelValue:n.data_type,"onUpdate:modelValue":a[4]||(a[4]=t=>n.data_type=t),label:"类型",placeholder:"请输入数据类型",required:""},null,8,["modelValue"]),o(w,{modelValue:n.content,"onUpdate:modelValue":a[5]||(a[5]=t=>n.content=t),type:"textarea",label:"内容",placeholder:"请输入数据内容",rows:"3",required:""},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])])}}},Se=ce(we,[["__scopeId","data-v-d76d7c97"]]);export{Se as default};
