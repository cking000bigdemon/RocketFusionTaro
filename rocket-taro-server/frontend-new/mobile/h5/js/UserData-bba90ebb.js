import{l as E,c as P,_ as N,L as F,t as R,d as j,r as m,ae as I,a as q,w as V,af as H,x as L,h as O,T as z,b as o,K,Z as B,ag as $,ah as G,k as M,v as Y,s as Z,y as C,z as U,B as p,A as J,a7 as D,a8 as Q,O as W,a9 as X,I as ee,aa as ae,a6 as te,E as oe,C as ne}from"./index-acb3025e.js";import{N as le,f as se,T as re}from"./index-fcf4e946.js";import{_ as ie}from"./_plugin-vue_export-helper-a85ffdf4.js";import{F as de,C as ce}from"./index-2cf87b80.js";import{F as ue}from"./index-29525019.js";const fe=Symbol(),me=()=>E(fe,null),[_e,h,ve]=P("list"),ge={error:Boolean,offset:N(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:F("down"),loadingText:String,finishedText:String,immediateCheck:R};var pe=j({name:_e,props:ge,emits:["load","update:error","update:loading"],setup(e,{emit:u,slots:s}){const i=m(e.loading),_=m(),v=m(),n=me(),y=I(_),g=q(()=>e.scroller||y.value),d=()=>{K(()=>{if(i.value||e.finished||e.disabled||e.error||(n==null?void 0:n.value)===!1)return;const{direction:l}=e,f=+e.offset,c=B(g);if(!c.height||$(_))return;let x=!1;const b=B(v);l==="up"?x=c.top-b.top<=f:x=b.bottom-c.bottom<=f,x&&(i.value=!0,u("update:loading",!0),u("load"))})},T=()=>{if(e.finished){const l=s.finished?s.finished():e.finishedText;if(l)return o("div",{class:h("finished-text")},[l])}},k=()=>{u("update:error",!1),d()},r=()=>{if(e.error){const l=s.error?s.error():e.errorText;if(l)return o("div",{role:"button",class:h("error-text"),tabindex:0,onClick:k},[l])}},t=()=>{if(i.value&&!e.finished&&!e.disabled)return o("div",{class:h("loading")},[s.loading?s.loading():o(G,{class:h("loading-icon")},{default:()=>[e.loadingText||ve("loading")]})])};return V(()=>[e.loading,e.finished,e.error],d),n&&V(n,l=>{l&&d()}),H(()=>{i.value=e.loading}),L(()=>{e.immediateCheck&&d()}),O({check:d}),z("scroll",d,{target:g,passive:!0}),()=>{var l;const f=(l=s.default)==null?void 0:l.call(s),c=o("div",{ref:v,class:h("placeholder")},null);return o("div",{ref:_,role:"feed",class:h(),"aria-busy":i.value},[e.direction==="down"?f:c,t(),T(),r(),e.direction==="up"?f:c])}}});const he=M(pe);const xe={class:"user-data-page"},be={class:"user-data-content"},we={__name:"UserData",setup(e){const u=Y(),s=m([]),i=m(!1),_=m(!1),v=m(!1),n=Z({name:"",description:"",data_type:"",content:""});function y(){u.platformAdapter.goBack()}async function g(){const r=await D.mobileGetUserData();r.data&&(s.value=r.data),i.value=!1,_.value=!0}function d(r){console.log("View detail:",r)}function T(r){return{text:"primary",json:"success",image:"warning",file:"default"}[r]||"default"}async function k(){try{await D.mobileAddUserData(n),Object.assign(n,{name:"",description:"",data_type:"",content:""}),await g(),await u.platformAdapter.showToast("添加成功","success")}catch{await u.platformAdapter.showToast("添加失败","error")}}return L(()=>{g()}),(r,t)=>{const l=ee,f=le,c=re,x=ce,b=he,w=de,S=ue,A=Q;return C(),U("div",xe,[o(f,{title:"我的数据","left-text":"返回","left-arrow":"",onClickLeft:y},{right:p(()=>[o(l,{name:"add-o",onClick:t[0]||(t[0]=a=>v.value=!0)})]),_:1}),J("div",be,[o(b,{loading:i.value,"onUpdate:loading":t[1]||(t[1]=a=>i.value=a),finished:_.value,"finished-text":"没有更多了",onLoad:g},{default:p(()=>[(C(!0),U(W,null,X(s.value,a=>(C(),ae(x,{key:a.id,title:a.name,label:a.description,value:te(se)(a.created_at),"is-link":"",onClick:ye=>d(a)},{"right-icon":p(()=>[o(c,{size:"mini",type:T(a.data_type)},{default:p(()=>[oe(ne(a.data_type),1)]),_:2},1032,["type"])]),_:2},1032,["title","label","value","onClick"]))),128))]),_:1},8,["loading","finished"])]),o(A,{show:v.value,"onUpdate:show":t[6]||(t[6]=a=>v.value=a),title:"添加数据","show-cancel-button":"",onConfirm:k},{default:p(()=>[o(S,null,{default:p(()=>[o(w,{modelValue:n.name,"onUpdate:modelValue":t[2]||(t[2]=a=>n.name=a),label:"名称",placeholder:"请输入数据名称",required:""},null,8,["modelValue"]),o(w,{modelValue:n.description,"onUpdate:modelValue":t[3]||(t[3]=a=>n.description=a),label:"描述",placeholder:"请输入描述（可选）"},null,8,["modelValue"]),o(w,{modelValue:n.data_type,"onUpdate:modelValue":t[4]||(t[4]=a=>n.data_type=a),label:"类型",placeholder:"请输入数据类型",required:""},null,8,["modelValue"]),o(w,{modelValue:n.content,"onUpdate:modelValue":t[5]||(t[5]=a=>n.content=a),type:"textarea",label:"内容",placeholder:"请输入数据内容",rows:"3",required:""},null,8,["modelValue"])]),_:1})]),_:1},8,["show"])])}}},Ue=ie(we,[["__scopeId","data-v-d76d7c97"]]);export{Ue as default};
